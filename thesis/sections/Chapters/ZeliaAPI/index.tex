\htwo{\ZELIA-API}
\label{sec:zeliaapi}

\hthree{Allgemein}

Die \ZELIA-API ist eine API, die die REST-Richtlinien erfüllt. Die verschiedenen Endpunkte geben einem Client die Möglichkeit, die Funktionalitäten des \ZELIA-Service zu nutzen. Da \ZELIA\ mehrere Funktionalitäten hat, gibt es dementsprechend mehrere Endpunkte in der API. In dem folgenden Kapiteln werden die wichtigsten Endpunkte von \ZELIA erläutert.

\hthree{Routen}
\hfour{/api/timegrid}
Der Endpunkt "/api/timegrid" liefert dem Client den Stundenplan seiner Klasse. Dies tut er, in dem er mithilfe der GET-Methode auf diesen Endpunkt zugreift. Falls der Server aus irgendeinem Grund Probleme hat den Request zu beantworten, schickt der Server einen Response mit Statuscode "500" an den Client.

\hfour{/api/room}

\yaml{code/ZeliaAPI/room.yaml}{Schnittstelle des Room-Endpunkts}

Der "/api/room"-Endpunkt gibt eine Liste von allen Räumen an der Schule zurück, die in Untis vorhanden sind. Zugegriffen wird auf den Endpunkt nur über die "GET"-Methode. Der "/api/room"-Endpunkt benötigt keine Parameter. Es gibt zwei mögliche Responses. Wenn am Server die Bearbeitung der Anfrage richtig abläuft, dann antwortet der Server mit Statuscode "200" und einem Array von Raumnamen. Die Raumnamen werden dabei als String mitgeliefert. 
Falls die Bearbeitung des Requests nicht funktioniert, antwortet der Server mit einer Antwort mit Statuscode "500".

\hfour{/api/room/\{roomNumber\}}

\yaml{code/ZeliaAPI/roomnumber.yaml}{Schnittstelle eines Raumes}

Wenn der Benutzer Informationen zu einem bestimmten Raum haben möchte, greift er mithilfe der "GET"-Methode auf den "/api/room/{roomNumber}" zu. Der Endpunkt benötigt einen Parameter. Dieser Parameter ist ein String und beinhaltet die Raumbezeichnung.  Wenn der mitgegebene Raum existiert, antwortet der Server mit einem Array, das ein Raumobjekt zurückliefert, welches Informationen zu diesem Raum beinhaltet. Das Objekt hat folgende Eigenschaften:

\begin{itemize}
    \item roomNumber -- String mit der Raumbezeichnung
    \item name -- String mit der Zusatzbezeichnung des Raumes
    \item description -- String mit einer kurzen Beschreibung des Raumes
    \item type -- String, der die Art des Objektes angibt. In diesem Fall ist es immer ein Objekt vom Typ "Class"
    \item isWheelchairAccesible -- Boolean-Wert, der die Zugänglichkeit für Rollstuhlfahrer*innen angibt.
    \item hasTeacherComputer -- Boolean-Wert, der angibt, ob der Raum über einen Lehrerrechner verfügt.
    \item projector -- String, der die Art des Projektors in dem Raum beschreibt.
    \item projectorConnectors -- String-Array, das die verschiedenen Anschlüsse des Projektors beinhaltet.
    \item hasWater -- Boolean-Wert, der angibt, ob der Raum über ein Waschbecken mit Wasserhahn verfügt. 
    \item boards -- String-Array, das die verschiedenen Tafeln im Raum beschreibt.
    \item numberOfComputers -- Integer-Wert, der die Anzahl der Computer in dem Raum angibt.
    \item numberOfSeats -- Integer-Wert, der die Anzahl der Sitzplätze im Raum angibt.
\end{itemize}

Falls der Parameter "roomNumber" keine gültige Raumnummer enthält, wird ein Response mit Statuscode "404" zurückgeschickt. 
Falls während der Bearbeitung des Requests ein Fehler auftritt, antwortet der Server mit einer Response mit Statuscode "500".

\hfour{/api/room/\{roomNumber\}/timetable}

\yaml{code/ZeliaAPI/timetable.yaml}{Schnittstelle eines Stundenplans}

Der Endpunkt "/api/room/\{roomNumber\}/timetable" liefert einem Client den Stundenplan zu einem gewünschten Raum. Der Raum wird dabei als Parameter mitgegeben. Auf den Endpunkt wird mithilfe der GET-Methode zugegriffen. Wenn bei der Bearbeitung keine Komplikationen auftreten, antwortet der Server mit einem Array von Lesson-Objekten. Wenn die beim Request mitgelieferte Raumbezeichnung nicht gültig ist, antwortet der Server mit einem Statuscode "404". Wenn bei der Bearbeitung des Requests ein anderer Fehler auftritt, antwortet der Server mit einem Statuscode "500".

\yaml{code/ZeliaAPI/lessonobjekt.yaml}{Schnittstelle eines Stunden-Objekts}

Ein Lesson-Objekt repräsentiert eine Unterrichtsstunde. Solch ein Objekt hat folgende Eigenschaften: 

\begin{itemize}
    \item id -- Eine von der WebUntis-API vergebene ID.
    \item date -- Datum der Unterrichtsstunde.
    \item startTime -- Anfang der Unterrichtsstunde.
    \item endTime -- Ende der Unterrichtsstunde.
    \item kl -- Array, dass mehrere Klassen-Objekte beinhaltet, die jeweils eine Klasse der Schule repräsentieren, die an diesem Unterricht teilnimmt. 
    \item te -- Array von Lehrer-Objekten, welche jeweils einen Lehrer der Schule repräsentieren, die diesen Unterricht führen. 
    \item su -- Array mit einem Gegenstands-Objekt, welches den Lehrgegenstand dieses Unterrichts repräsentiert.
    \item ro -- Array, dass Raum-Objekte beinhaltet, die jeweils einen Raum repräsentieren, der für diesen Unterricht verwendet wird. 
    \item activityType -- String welcher die Art des Unterrichts repräsentiert. 
\end{itemize}

\hfour{/api/room/\{roomNumber\}/book}

\yaml{code/ZeliaAPI/booking.yaml}{Schnittstelle des Buchungs-Endpunkts}

Mithilfe des Endpunktes "/api/room/\{roomNumber\}/book" kann ein Client einen Raum buchen. Die Raumbezeichnung des zu buchenden Raums wird dabei als Parameter mitgegeben. Der Client verwendet dazu die POST-Methode. Im Body des Requests muss ein Objekt mit folgender Struktur mitgeschickt werden: 

\begin{itemize}
    \item user -- String, der den Benutzernamen des Clients beinhaltet. 
    \item purpose -- String, der den Grund zur Buchung beinhaltet.
    \item from -- Integerwert, der das Anfangsdatum der Buchung beinhaltet.
    \item until -- Integerwert, der das Enddatum der Buchung beinhaltet.
    \item date -- Integerwert, der den Tag der Buchung beinhaltet. 
\end{itemize}

Wenn das Objekt im Request-body nicht den Anforderungen entspricht, wird ein Response mit Statuscode "400" zurückgeschickt. 

\hfour{/api/room/\{roomNumber\}/report}

\yaml{code/ZeliaAPI/report.yaml}{Schnittstelle eines Meldungs-Endpunkts}

Der "/api/room/\{roomNumber\}/report"-Endpunkt ermöglicht es einem Client, Beschwerden oder Schäden bezüglich eines Raumes einzureichen. Der betreffende Raum wird als Parameter mitgegeben. Um eine Beschwerde einzureichen, tätigt der Client auf diesen Endpunkt einen POST-Request. Im Request-Body schickt der Client ein Objekt mit, das die Beschwerde näher beschreibt. Das Objekt hat folgende Eigenschaften:

\begin{itemize}
    \item user -- String, der den Benutzernamen des Clients beinhaltet.
    \item firstDetected -- Integerwert, der das Datum beinhaltet, an dem der Schaden entdeckt wurde. 
    \item information -- String, in dem genauere Informationen zur Beschwerde stehen. 
    \item roomNumber -- String, in dem die Raumbezeichnung des betreffenden Raums steht. 
\end{itemize}

Wenn kein Fehler auftritt, antwortet der Server mit Statuscode "200". Wenn das Objekt im Request-Body ungültige Informationen enthält, antwortet der Server mit einem Statuscode "400".

\pagebreak

\hfour{Klassen-Objekt}

\yaml{code/ZeliaAPI/Klassenobjekt.yaml}{Definiton eines Klassen-Objekts}

Ein Klassen-Objekt repräsentiert eine Klasse in der Schule. Ein Klassen-Objekt hat folgende Eigenschaften: 

\begin{itemize}
    \item id -- Integerwert, er eine von der WebUntis-API vergebene ID enthält. 
    \item name -- String, der den Klassennamen enthält. 
    \item longname -- String, der den vollständigen Klassennamen enthält. 
\end{itemize}

\hfour{Lehrer-Objekt}

\yaml{code/ZeliaAPI/Lehrerobjekt.yaml}{Definiton eines Lehrer-Objekts}

Ein Lehrer-Objekt repräsentiert einen Lehrer an der Schule. Ein Lehrer-Objekt hat folgende Eigenschaften: 

\begin{itemize}
    \item id -- Integerwert, der eine von der WebUntis-API vergebene ID enthält.
    \item name -- String, der die Abkürzung des Lehrers beinhaltet.
    \item longname -- String, der den Nachnamen des Lehrers beinhaltet. 
\end{itemize}

\hfour{Gegenstands-Objekt}

\yaml{code/ZeliaAPI/Gegenstandsobjekt.yaml}{Definition eines Gegenstands-Objekts}

Ein Gegenstands-Objekt repräsentiert einen Lehrgegenstand. Ein Gegenstands-Objekt hat folgende Eigenschaften: 

\begin{itemize}
    \item id -- Integerwert, der eine von der WebUntis-API vergebene ID enthält. 
    \item name -- String, der die Abkürzung des Lehrgegenstands enthält.
    \item longname -- String, der den vollständigen Namen des Lehrgegenstands enthält
\end{itemize}

\hfour{Raumobjekt}

\yaml{code/ZeliaAPI/Raumobjekt.yaml}{Definition eines Raumobjekts}

\pagebreak

Ein Raum-Objekt repräsentiert einen Raum in der Schule. Ein Raum-Objekt hat folgende Eigenschaften: 

\begin{itemize}
    \item id -- Integerwert, der eine von der WebUntis-API vergebene ID enthält.
    \item name -- String, der die Abkürzung beziehungsweise die Kurzschreibweise des Raums enthält.
    \item longname -- String, der den gesamten Namen des Raums enthält. 
\end{itemize}